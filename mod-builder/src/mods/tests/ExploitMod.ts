/// <reference path="../../helpers/global.d.ts" />

import { registerMod } from "../../helpers/utils";

export default class ExploitMod extends IBaseMod {
    static get modName() {
        return "Security tester";
    }
    static get description() {
        return "This mod should fail to compile because could should not be run because of asynchronous methods";
    }
    static get version() {
        return "";
    }
    onLoad() {
        console.log("You should not see this message");
    }
    onUnload() {
        console.log("You should not see this message either");
    }
}

function tryRun (type: string, method: () => void) {
    if (typeof window === "undefined" || typeof window.navigator === "undefined") return; // do not run in builder
    try {
        method();
        console.log(`${type} ran successfully`);
    } catch (error) {
        console.error(`${type} failed successfully`);
        throw error;
    }
}

tryRun("setTimeout", () => {
    setTimeout(() => {
    });
});
tryRun("window.setTimeout", () => {
    window.setTimeout(() => {
    });
});
tryRun("setInterval", () => {
    setInterval(() => {
        console.log("fireeee");
    });
});
tryRun("window.setInterval", () => {
    window.setInterval(() => {
        console.log("fireeee");
    });
});
tryRun("window.requestAnimationFrame", () => {
    window.requestAnimationFrame(() => {
    });
});
tryRun("requestAnimationFrame", () => {
    requestAnimationFrame(() => {
    });
});

registerMod(ExploitMod);
